(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{16341:(e,t,r)=>{"use strict";r.d(t,{$W:()=>c,jm:()=>d});var s=r(12469),a=r(24343),n=r(2818);let i=s.Ik({NEXT_PUBLIC_SUPABASE_URL:s.Yj().url().min(1,"Supabase URL is required"),NEXT_PUBLIC_SUPABASE_ANON_KEY:s.Yj().min(1,"Supabase anon key is required"),SUPABASE_SERVICE_ROLE_KEY:s.Yj().min(1,"Supabase service role key is required").optional(),NODE_ENV:s.k5(["development","production","test"]).default("development"),NEXT_PUBLIC_APP_URL:s.Yj().url().default("http://localhost:3000"),NEXTAUTH_SECRET:s.Yj().optional(),NEXTAUTH_URL:s.Yj().url().optional(),NEXT_PUBLIC_VERCEL_ANALYTICS_ID:s.Yj().optional(),SENTRY_DSN:s.Yj().optional(),SENTRY_ORG:s.Yj().optional(),SENTRY_PROJECT:s.Yj().optional(),ADMIN_EMAIL:s.Yj().email().default("hello@zimojin.com"),SUPER_ADMIN_EMAILS:s.Yj().default("hello@zimojin.com")}),l=function(){let e={NEXT_PUBLIC_SUPABASE_URL:"https://your-project-id.supabase.co",NEXT_PUBLIC_SUPABASE_ANON_KEY:"your-anon-key-here",SUPABASE_SERVICE_ROLE_KEY:n.env.SUPABASE_SERVICE_ROLE_KEY,NODE_ENV:"production",NEXT_PUBLIC_APP_URL:"https://admin.coffeejournalFresh.com",NEXTAUTH_SECRET:n.env.NEXTAUTH_SECRET,NEXTAUTH_URL:n.env.NEXTAUTH_URL,NEXT_PUBLIC_VERCEL_ANALYTICS_ID:"your-analytics-id",SENTRY_DSN:n.env.SENTRY_DSN,SENTRY_ORG:n.env.SENTRY_ORG,SENTRY_PROJECT:n.env.SENTRY_PROJECT,ADMIN_EMAIL:n.env.ADMIN_EMAIL,SUPER_ADMIN_EMAILS:n.env.SUPER_ADMIN_EMAILS};try{return i.parse(e)}catch(e){if(e instanceof a.G){let t=e.errors.map(e=>"".concat(e.path.join("."),": ").concat(e.message)).join("\n");throw Error("❌ Environment configuration error:\n".concat(t,"\n\n")+"Please check your .env file and ensure all required variables are set.\nSee .env.example for reference.")}throw e}}();l.NODE_ENV,l.NODE_ENV,l.NODE_ENV;let o=()=>l.SUPER_ADMIN_EMAILS.split(",").map(e=>e.trim()),d=e=>o().includes(e),c={app:{name:"Coffee Journal Admin",version:"1.0.0",url:l.NEXT_PUBLIC_APP_URL,adminEmail:l.ADMIN_EMAIL},supabase:{url:l.NEXT_PUBLIC_SUPABASE_URL,anonKey:l.NEXT_PUBLIC_SUPABASE_ANON_KEY,serviceRoleKey:l.SUPABASE_SERVICE_ROLE_KEY},auth:{secret:l.NEXTAUTH_SECRET,url:l.NEXTAUTH_URL},monitoring:{vercelAnalyticsId:l.NEXT_PUBLIC_VERCEL_ANALYTICS_ID,sentry:{dsn:l.SENTRY_DSN,org:l.SENTRY_ORG,project:l.SENTRY_PROJECT}}}},21567:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(43463),a=r(69795);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},22130:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>l});var s=r(95155),a=r(12115),n=r(21567);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},25121:(e,t,r)=>{"use strict";r.d(t,{E:()=>l});var s=r(95155);r(12115);var a=r(31027),n=r(21567);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:r}),t),...a})}},33900:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(95155),a=r(12115),n=r(21567);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},61086:(e,t,r)=>{"use strict";r.d(t,{N:()=>i,U:()=>n});var s=r(88481),a=r(16341);function n(){return(0,s.createBrowserClient)(a.$W.supabase.url,a.$W.supabase.anonKey,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Name":"coffee-journal-admin","X-Client-Version":"1.0.0"}}})}let i=n()},61326:(e,t,r)=>{Promise.resolve().then(r.bind(r,94541))},65564:(e,t,r)=>{"use strict";r.d(t,{dj:()=>f});var s=r(12115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],d={toasts:[]};function c(e){d=l(d,e),o.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=(0,s.useState)(d);return(0,s.useEffect)(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},72508:(e,t,r)=>{"use strict";r.d(t,{A0:()=>l,BF:()=>o,Hj:()=>d,XI:()=>i,nA:()=>u,nd:()=>c});var s=r(95155),a=r(12115),n=r(21567);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",r),...a})})});i.displayName="Table";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",r),...a})});l.displayName="TableHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",r),...a})});o.displayName="TableBody",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...a})}).displayName="TableFooter";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...a})});d.displayName="TableRow";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...a})});c.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",r),...a})}).displayName="TableCaption"},73312:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>o});var s=r(95155),a=r(12115),n=r(12317),i=r(31027),l=r(21567);let o=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,s.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:r})),ref:t,...c})});d.displayName="Button"},94541:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var s=r(95155),a=r(12115),n=r(61086),i=r(65564),l=r(73312),o=r(33900),d=r(22130),c=r(25121),u=r(72508),f=r(14505),m=r(20853),x=r(1466),p=r(2746),h=r(42640),N=r(98144);function _(){let[e,t]=(0,a.useState)([]),[r,_]=(0,a.useState)(""),[E,j]=(0,a.useState)(!0),{toast:v}=(0,i.dj)(),b=(0,n.U)();(0,a.useEffect)(()=>{g()},[]);let g=async()=>{j(!0);try{let{data:e,error:r}=await b.from("user_profiles").select("*").order("created_at",{ascending:!1});if(r)throw r;t(e||[])}catch(e){v({title:"오류",description:"사용자 목록을 불러오는데 실패했습니다.",variant:"destructive"})}finally{j(!1)}},A=async e=>{try{let{error:t}=await b.from("user_profiles").update({is_moderator:!e.is_moderator}).eq("id",e.id);if(t)throw t;v({title:"성공",description:"".concat(e.username,"의 모더레이터 권한이 ").concat(e.is_moderator?"해제":"부여","되었습니다.")}),g()}catch(e){v({title:"오류",description:"권한 변경에 실패했습니다.",variant:"destructive"})}},y=async e=>{try{let{error:t}=await b.from("user_profiles").update({is_verified:!e.is_verified}).eq("id",e.id);if(t)throw t;v({title:"성공",description:"".concat(e.username,"의 인증 상태가 변경되었습니다.")}),g()}catch(e){v({title:"오류",description:"인증 상태 변경에 실패했습니다.",variant:"destructive"})}},S=e.filter(e=>{var t;return e.username.toLowerCase().includes(r.toLowerCase())||(null===(t=e.display_name)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase()))||e.id.toLowerCase().includes(r.toLowerCase())});return E?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)(f.A,{className:"h-8 w-8 animate-spin"})}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"사용자 관리"}),(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,s.jsx)(o.p,{placeholder:"사용자 검색...",value:r,onChange:e=>_(e.target.value),className:"pl-10 w-64"})]})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-4 mb-8",children:[(0,s.jsxs)(d.Zp,{children:[(0,s.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(d.ZB,{className:"text-sm font-medium",children:"전체 사용자"}),(0,s.jsx)(x.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.length})})]}),(0,s.jsxs)(d.Zp,{children:[(0,s.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(d.ZB,{className:"text-sm font-medium",children:"인증된 사용자"}),(0,s.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.filter(e=>e.is_verified).length})})]}),(0,s.jsxs)(d.Zp,{children:[(0,s.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(d.ZB,{className:"text-sm font-medium",children:"모더레이터"}),(0,s.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.filter(e=>e.is_moderator).length})})]}),(0,s.jsxs)(d.Zp,{children:[(0,s.jsx)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,s.jsx)(d.ZB,{className:"text-sm font-medium",children:"평균 레벨"})}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.length>0?(e.reduce((e,t)=>e+t.level,0)/e.length).toFixed(1):"0"})})]})]}),(0,s.jsxs)(d.Zp,{children:[(0,s.jsx)(d.aR,{children:(0,s.jsxs)(d.ZB,{children:["사용자 목록 (",S.length,"명)"]})}),(0,s.jsx)(d.Wu,{children:(0,s.jsxs)(u.XI,{children:[(0,s.jsx)(u.A0,{children:(0,s.jsxs)(u.Hj,{children:[(0,s.jsx)(u.nd,{children:"사용자명"}),(0,s.jsx)(u.nd,{children:"레벨"}),(0,s.jsx)(u.nd,{children:"테이스팅"}),(0,s.jsx)(u.nd,{children:"상태"}),(0,s.jsx)(u.nd,{children:"가입일"}),(0,s.jsx)(u.nd,{className:"text-right",children:"액션"})]})}),(0,s.jsx)(u.BF,{children:S.map(e=>(0,s.jsxs)(u.Hj,{children:[(0,s.jsx)(u.nA,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.username}),e.display_name&&(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.display_name})]})}),(0,s.jsx)(u.nA,{children:(0,s.jsxs)(c.E,{variant:"outline",children:["Lv.",e.level]})}),(0,s.jsx)(u.nA,{children:e.total_tastings}),(0,s.jsx)(u.nA,{children:(0,s.jsxs)("div",{className:"flex gap-1",children:[e.is_verified&&(0,s.jsx)(c.E,{variant:"default",children:"인증됨"}),e.is_moderator&&(0,s.jsx)(c.E,{variant:"secondary",children:"모더레이터"})]})}),(0,s.jsx)(u.nA,{children:new Date(e.created_at).toLocaleDateString("ko-KR")}),(0,s.jsx)(u.nA,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>y(e),children:e.is_verified?(0,s.jsx)(N.A,{className:"h-4 w-4"}):(0,s.jsx)(p.A,{className:"h-4 w-4"})}),(0,s.jsx)(l.$,{size:"sm",variant:"outline",onClick:()=>A(e),children:e.is_moderator?(0,s.jsx)(N.A,{className:"h-4 w-4"}):(0,s.jsx)(h.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[96,358],()=>t(61326)),_N_E=e.O()}]);